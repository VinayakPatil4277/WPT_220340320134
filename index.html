<html>
<head>
  <script
  src="https://code.jquery.com/jquery-3.6.0.js"
  ></script>

<script>

$( 
()=>{


function getItemOnbookid(bookid){
 
 
 for(let i=0; i < book.length;i++)
	{
	if(items[i].bookid ==bookid)
	{
		output.bookidfoundstatus=true;
		output.itemdetails=items[i];
		break;	
	
	}
		
	}
return output;

}
function updateItem(updatedObject)
{
let updated = false;
for(let i=0; i < items.length;i++)
	{
	if(items[i].bookid == updatedObject.bookid)
	{
		items[i].price=updatedObject.price;
		items[i].bookname=updatedObject.bookname;
		updated=true;
		break;
	}
	}
return updated;

}

function showContents()
{
  let ajaxparams={
  data:{},
  url: "http://localhost:900/getAllItems",
  type:'get',
  dataType: "json",
  success:(dgbs)=>{ items = dgbs; 
  
    let itemscontents="";
	for(let i=0; i < items.length;i++)
	{
	itemscontents += "<br/>" + items[i].bookid + "  " + items[i].bookname + " " + items[i].price;
	}
	$("#contents").html(itemscontents);

  },
  error:(error)=>{ console.log("failure " + error)}

};
$.ajax(ajaxparams);
	
}




$("#bookid").blur(()=>{


let y=$("#bookid").val();



document.querySelector("#bookid").disabled=true;

let ajaxparams={
  data:{ x:y},
  url: "http://localhost:900/getItem",
  type:'get',
  dataType: "json",
  success:(output)=>{ 

    if(output.bookidfoundstatus)
{


$("#message").text("item details found");

$("#bookname").val(output.itemdetails.bookname);

document.querySelector("#bookname").value=
output.itemdetails.bookname;


$("#bookprice").val(output.itemdetails.price);






}

else
{

$("#message").text("item details not found");
$("#bookname").val("");
$("#bookprice").val("");

}


  },
  error:(error)=>{ console.log("failure " + error)}

};
$.ajax(ajaxparams);


});




$("#add").click(
	()=>{
  
 
  
  let input={x:$("#bookid").val(),
  y:$("#bookname").val(),z:$("#bookprice").val()};

  let ajaxparams={
  data:input,
  url: "http://localhost:900/addItem",
  type:'get',
  dataType: "json",
  success:(output)=>{ 


    if(output)
  {
  
  $("#message").text("added succesfully");
   $("#message").removeClass("nm").addClass("em");
  
  }
  else
  
  {
 $("#message").text("could not add item");
  
  }

$("#bookname").val("");
$("#bookprice").val("");

	showContents();

	document.querySelector("#bookid").disabled=false;

  },
  error:(errr)=>{ console.log("failure" + errr);}
  };
  $.ajax(ajaxparams);

}); 




$("#update").click(()=>{


let input ={bookid:$("#bookid").val(),
  bookname:$("#bookname").val(),price:$("#bookprice").val()};
  
  
  let ajaxparams={
    
  data:input,
  url: "http://localhost:900/updateitem",
  type:'get',
  dataType: "json",
  success:(output)=>{

    
    if(output)
  {
  $("#message").text("updated successfully");
  $("#message").removeClass("em").addClass("nm");
  
  }
  else
  
  {
  
    $("#message").text("could not update item");
  
  
  }
  $("#bookname").val("");
  $("#bookprice").val("");

	showContents();

  document.querySelector("#bookid").disabled=false;
  document.querySelector("#bookid").focus();
  

  },
  error:(mistake)=> { console.log("error " + mistake);}
   };
   $.ajax(ajaxparams);

});

showContents();

});

</script>
<style>
.em  { color:green }
.nm { color:blue }

</style>
</head>
<body>
<Br/>
<input type="text" id="bookid" placeholder="book number"/>
<span id="message"> What happen</span>
<Br/>
<input type="text" id="bookname" placeholder="book name"/>
<Br/>
<input type="text" id="bookprice" placeholder="book price"/>

<br>
<button id="update">update Book</button>
<hr/>
<p id="contents"> all items show it here</p>




</body>
</html>